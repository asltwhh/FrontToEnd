{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n/* tslint:disable:jsx-no-multiline-js */\n\n\nimport treeFilter from 'array-tree-filter';\nimport * as React from 'react';\nimport RMCCascader from 'rmc-cascader/es/Cascader';\nimport RMCPopupCascader from 'rmc-cascader/es/Popup';\nimport RMCMultiPicker from 'rmc-picker/es/MultiPicker';\nimport RMCPicker from 'rmc-picker/es/Picker';\nimport { getComponentLocale } from '../_util/getLocale';\nexport function getDefaultProps() {\n  var defaultFormat = function defaultFormat(values) {\n    // label is JSX.Element or other\n    if (values.length > 0 && typeof values[0] !== 'string') {\n      return values;\n    }\n\n    return values.join(',');\n  };\n\n  return {\n    triggerType: 'onClick',\n    prefixCls: 'am-picker',\n    pickerPrefixCls: 'am-picker-col',\n    popupPrefixCls: 'am-picker-popup',\n    format: defaultFormat,\n    cols: 3,\n    cascade: true,\n    title: ''\n  };\n}\n\nvar AbstractPicker = function (_React$Component) {\n  _inherits(AbstractPicker, _React$Component);\n\n  function AbstractPicker() {\n    _classCallCheck(this, AbstractPicker);\n\n    var _this = _possibleConstructorReturn(this, (AbstractPicker.__proto__ || Object.getPrototypeOf(AbstractPicker)).apply(this, arguments));\n\n    _this.getSel = function () {\n      var value = _this.props.value || [];\n      var treeChildren = void 0;\n      var data = _this.props.data;\n\n      if (_this.props.cascade) {\n        treeChildren = treeFilter(data, function (c, level) {\n          return c.value === value[level];\n        });\n      } else {\n        treeChildren = value.map(function (v, i) {\n          return data[i].filter(function (d) {\n            return d.value === v;\n          })[0];\n        });\n      }\n\n      return _this.props.format && _this.props.format(treeChildren.map(function (v) {\n        return v.label;\n      }));\n    };\n\n    _this.getPickerCol = function () {\n      var _this$props = _this.props,\n          data = _this$props.data,\n          pickerPrefixCls = _this$props.pickerPrefixCls,\n          itemStyle = _this$props.itemStyle,\n          indicatorStyle = _this$props.indicatorStyle;\n      return data.map(function (col, index) {\n        return React.createElement(RMCPicker, {\n          key: index,\n          prefixCls: pickerPrefixCls,\n          style: {\n            flex: 1\n          },\n          itemStyle: itemStyle,\n          indicatorStyle: indicatorStyle\n        }, col.map(function (item) {\n          return React.createElement(RMCPicker.Item, {\n            key: item.value,\n            value: item.value\n          }, item.label);\n        }));\n      });\n    };\n\n    _this.onOk = function (v) {\n      if (_this.scrollValue !== undefined) {\n        v = _this.scrollValue;\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(v);\n      }\n\n      if (_this.props.onOk) {\n        _this.props.onOk(v);\n      }\n    };\n\n    _this.setScrollValue = function (v) {\n      _this.scrollValue = v;\n    };\n\n    _this.setCasecadeScrollValue = function (v) {\n      // 级联情况下保证数据正确性，滚动过程中只有当最后一级变化时才变更数据\n      if (v && _this.scrollValue) {\n        var length = _this.scrollValue.length;\n\n        if (length === v.length && _this.scrollValue[length - 1] === v[length - 1]) {\n          return;\n        }\n      }\n\n      _this.setScrollValue(v);\n    };\n\n    _this.fixOnOk = function (cascader) {\n      if (cascader && cascader.onOk !== _this.onOk) {\n        cascader.onOk = _this.onOk;\n        cascader.forceUpdate();\n      }\n    };\n\n    _this.onPickerChange = function (v) {\n      _this.setScrollValue(v);\n\n      if (_this.props.onPickerChange) {\n        _this.props.onPickerChange(v);\n      }\n    };\n\n    _this.onVisibleChange = function (visible) {\n      _this.setScrollValue(undefined);\n\n      if (_this.props.onVisibleChange) {\n        _this.props.onVisibleChange(visible);\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(AbstractPicker, [{\n    key: 'render',\n    value: function render() {\n      var _a = this.props,\n          children = _a.children,\n          _a$value = _a.value,\n          value = _a$value === undefined ? [] : _a$value,\n          popupPrefixCls = _a.popupPrefixCls,\n          itemStyle = _a.itemStyle,\n          indicatorStyle = _a.indicatorStyle,\n          okText = _a.okText,\n          dismissText = _a.dismissText,\n          extra = _a.extra,\n          cascade = _a.cascade,\n          prefixCls = _a.prefixCls,\n          pickerPrefixCls = _a.pickerPrefixCls,\n          data = _a.data,\n          cols = _a.cols,\n          onOk = _a.onOk,\n          restProps = __rest(_a, [\"children\", \"value\", \"popupPrefixCls\", \"itemStyle\", \"indicatorStyle\", \"okText\", \"dismissText\", \"extra\", \"cascade\", \"prefixCls\", \"pickerPrefixCls\", \"data\", \"cols\", \"onOk\"]); // tslint:disable-next-line:variable-name\n\n\n      var _locale = getComponentLocale(this.props, this.context, 'Picker', function () {\n        return require('./locale/zh_CN');\n      });\n\n      var cascader = void 0;\n      var popupMoreProps = {};\n\n      if (cascade) {\n        cascader = React.createElement(RMCCascader, {\n          prefixCls: prefixCls,\n          pickerPrefixCls: pickerPrefixCls,\n          data: data,\n          cols: cols,\n          onChange: this.onPickerChange,\n          onScrollChange: this.setCasecadeScrollValue,\n          pickerItemStyle: itemStyle,\n          indicatorStyle: indicatorStyle\n        });\n      } else {\n        cascader = React.createElement(RMCMultiPicker, {\n          style: {\n            flexDirection: 'row',\n            alignItems: 'center'\n          },\n          prefixCls: prefixCls,\n          onScrollChange: this.setScrollValue\n        }, this.getPickerCol());\n        popupMoreProps = {\n          pickerValueProp: 'selectedValue',\n          pickerValueChangeProp: 'onValueChange'\n        };\n      }\n\n      return React.createElement(RMCPopupCascader, _extends({\n        cascader: cascader\n      }, this.popupProps, restProps, {\n        prefixCls: popupPrefixCls,\n        value: value,\n        dismissText: dismissText || _locale.dismissText,\n        okText: okText || _locale.okText\n      }, popupMoreProps, {\n        ref: this.fixOnOk,\n        onVisibleChange: this.onVisibleChange\n      }), children && typeof children !== 'string' && React.isValidElement(children) && React.cloneElement(children, {\n        extra: this.getSel() || extra || _locale.extra\n      }));\n    }\n  }]);\n\n  return AbstractPicker;\n}(React.Component);\n\nexport default AbstractPicker;","map":{"version":3,"sources":["E:/mycode/redux-note/node_modules/antd-mobile/es/picker/AbstractPicker.js"],"names":["_extends","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","treeFilter","React","RMCCascader","RMCPopupCascader","RMCMultiPicker","RMCPicker","getComponentLocale","getDefaultProps","defaultFormat","values","join","triggerType","prefixCls","pickerPrefixCls","popupPrefixCls","format","cols","cascade","title","AbstractPicker","_React$Component","_this","__proto__","getPrototypeOf","apply","arguments","getSel","value","props","treeChildren","data","c","level","map","v","filter","d","label","getPickerCol","_this$props","itemStyle","indicatorStyle","col","index","createElement","key","style","flex","item","Item","onOk","scrollValue","undefined","onChange","setScrollValue","setCasecadeScrollValue","fixOnOk","cascader","forceUpdate","onPickerChange","onVisibleChange","visible","render","_a","children","_a$value","okText","dismissText","extra","restProps","_locale","context","require","popupMoreProps","onScrollChange","pickerItemStyle","flexDirection","alignItems","pickerValueProp","pickerValueChangeProp","popupProps","ref","isValidElement","cloneElement","Component"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nvar __rest = this && this.__rest || function (s, e) {\n    var t = {};\n    for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n    }if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n        if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n    }return t;\n};\n/* tslint:disable:jsx-no-multiline-js */\nimport treeFilter from 'array-tree-filter';\nimport * as React from 'react';\nimport RMCCascader from 'rmc-cascader/es/Cascader';\nimport RMCPopupCascader from 'rmc-cascader/es/Popup';\nimport RMCMultiPicker from 'rmc-picker/es/MultiPicker';\nimport RMCPicker from 'rmc-picker/es/Picker';\nimport { getComponentLocale } from '../_util/getLocale';\nexport function getDefaultProps() {\n    var defaultFormat = function defaultFormat(values) {\n        // label is JSX.Element or other\n        if (values.length > 0 && typeof values[0] !== 'string') {\n            return values;\n        }\n        return values.join(',');\n    };\n    return {\n        triggerType: 'onClick',\n        prefixCls: 'am-picker',\n        pickerPrefixCls: 'am-picker-col',\n        popupPrefixCls: 'am-picker-popup',\n        format: defaultFormat,\n        cols: 3,\n        cascade: true,\n        title: ''\n    };\n}\n\nvar AbstractPicker = function (_React$Component) {\n    _inherits(AbstractPicker, _React$Component);\n\n    function AbstractPicker() {\n        _classCallCheck(this, AbstractPicker);\n\n        var _this = _possibleConstructorReturn(this, (AbstractPicker.__proto__ || Object.getPrototypeOf(AbstractPicker)).apply(this, arguments));\n\n        _this.getSel = function () {\n            var value = _this.props.value || [];\n            var treeChildren = void 0;\n            var data = _this.props.data;\n\n            if (_this.props.cascade) {\n                treeChildren = treeFilter(data, function (c, level) {\n                    return c.value === value[level];\n                });\n            } else {\n                treeChildren = value.map(function (v, i) {\n                    return data[i].filter(function (d) {\n                        return d.value === v;\n                    })[0];\n                });\n            }\n            return _this.props.format && _this.props.format(treeChildren.map(function (v) {\n                return v.label;\n            }));\n        };\n        _this.getPickerCol = function () {\n            var _this$props = _this.props,\n                data = _this$props.data,\n                pickerPrefixCls = _this$props.pickerPrefixCls,\n                itemStyle = _this$props.itemStyle,\n                indicatorStyle = _this$props.indicatorStyle;\n\n            return data.map(function (col, index) {\n                return React.createElement(\n                    RMCPicker,\n                    { key: index, prefixCls: pickerPrefixCls, style: { flex: 1 }, itemStyle: itemStyle, indicatorStyle: indicatorStyle },\n                    col.map(function (item) {\n                        return React.createElement(\n                            RMCPicker.Item,\n                            { key: item.value, value: item.value },\n                            item.label\n                        );\n                    })\n                );\n            });\n        };\n        _this.onOk = function (v) {\n            if (_this.scrollValue !== undefined) {\n                v = _this.scrollValue;\n            }\n            if (_this.props.onChange) {\n                _this.props.onChange(v);\n            }\n            if (_this.props.onOk) {\n                _this.props.onOk(v);\n            }\n        };\n        _this.setScrollValue = function (v) {\n            _this.scrollValue = v;\n        };\n        _this.setCasecadeScrollValue = function (v) {\n            // 级联情况下保证数据正确性，滚动过程中只有当最后一级变化时才变更数据\n            if (v && _this.scrollValue) {\n                var length = _this.scrollValue.length;\n                if (length === v.length && _this.scrollValue[length - 1] === v[length - 1]) {\n                    return;\n                }\n            }\n            _this.setScrollValue(v);\n        };\n        _this.fixOnOk = function (cascader) {\n            if (cascader && cascader.onOk !== _this.onOk) {\n                cascader.onOk = _this.onOk;\n                cascader.forceUpdate();\n            }\n        };\n        _this.onPickerChange = function (v) {\n            _this.setScrollValue(v);\n            if (_this.props.onPickerChange) {\n                _this.props.onPickerChange(v);\n            }\n        };\n        _this.onVisibleChange = function (visible) {\n            _this.setScrollValue(undefined);\n            if (_this.props.onVisibleChange) {\n                _this.props.onVisibleChange(visible);\n            }\n        };\n        return _this;\n    }\n\n    _createClass(AbstractPicker, [{\n        key: 'render',\n        value: function render() {\n            var _a = this.props,\n                children = _a.children,\n                _a$value = _a.value,\n                value = _a$value === undefined ? [] : _a$value,\n                popupPrefixCls = _a.popupPrefixCls,\n                itemStyle = _a.itemStyle,\n                indicatorStyle = _a.indicatorStyle,\n                okText = _a.okText,\n                dismissText = _a.dismissText,\n                extra = _a.extra,\n                cascade = _a.cascade,\n                prefixCls = _a.prefixCls,\n                pickerPrefixCls = _a.pickerPrefixCls,\n                data = _a.data,\n                cols = _a.cols,\n                onOk = _a.onOk,\n                restProps = __rest(_a, [\"children\", \"value\", \"popupPrefixCls\", \"itemStyle\", \"indicatorStyle\", \"okText\", \"dismissText\", \"extra\", \"cascade\", \"prefixCls\", \"pickerPrefixCls\", \"data\", \"cols\", \"onOk\"]);\n            // tslint:disable-next-line:variable-name\n            var _locale = getComponentLocale(this.props, this.context, 'Picker', function () {\n                return require('./locale/zh_CN');\n            });\n            var cascader = void 0;\n            var popupMoreProps = {};\n            if (cascade) {\n                cascader = React.createElement(RMCCascader, { prefixCls: prefixCls, pickerPrefixCls: pickerPrefixCls, data: data, cols: cols, onChange: this.onPickerChange, onScrollChange: this.setCasecadeScrollValue, pickerItemStyle: itemStyle, indicatorStyle: indicatorStyle });\n            } else {\n                cascader = React.createElement(\n                    RMCMultiPicker,\n                    { style: { flexDirection: 'row', alignItems: 'center' }, prefixCls: prefixCls, onScrollChange: this.setScrollValue },\n                    this.getPickerCol()\n                );\n                popupMoreProps = {\n                    pickerValueProp: 'selectedValue',\n                    pickerValueChangeProp: 'onValueChange'\n                };\n            }\n            return React.createElement(\n                RMCPopupCascader,\n                _extends({ cascader: cascader }, this.popupProps, restProps, { prefixCls: popupPrefixCls, value: value, dismissText: dismissText || _locale.dismissText, okText: okText || _locale.okText }, popupMoreProps, { ref: this.fixOnOk, onVisibleChange: this.onVisibleChange }),\n                children && typeof children !== 'string' && React.isValidElement(children) && React.cloneElement(children, {\n                    extra: this.getSel() || extra || _locale.extra\n                })\n            );\n        }\n    }]);\n\n    return AbstractPicker;\n}(React.Component);\n\nexport default AbstractPicker;"]},"metadata":{},"sourceType":"module"}