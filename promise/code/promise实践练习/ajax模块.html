<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="container">
        <h2>Promise 封装ajax操作</h2>
        <button id='btn'>点击发送ajax请求</button>
    </div>
    <script>
        btn.onclick = function(){
            // 不用promise
            // const xhr = new XMLHttpRequest();
            // xhr.open('get','https://api.apiopen.top/getJok');
            // xhr.send();    
            // xhr.onreadystatechange = function(){
            //     if(xhr.readyState == 4){
            //         if(xhr.status>=200 && xhr.status<=300){
            //             // 控制台输出响应状态码
            //             console.log(xhr.response)
            //         }else{
            //             // 控制天输出无响应状态码
            //             console.log(xhr.status)
            //         }
            //     }  
            // }
            // 使用promise
            // let p = new Promise((resolve,reject)=>{   
            //     const xhr = new XMLHttpRequest();
            //     xhr.open('get','https://api.apiopen.top/getJoke');
            //     xhr.send();    
            //     xhr.onreadystatechange = function(){
            //         if(xhr.readyState == 4){
            //             if(xhr.status>=200 && xhr.status<=300){
            //                 // 控制台输出响应状态码
            //                 resolve(xhr.response);
            //             }else{
            //                 // 控制天输出无响应状态码
            //                 reject(xhr.status)
            //             }
            //         }  
            //     }
            // })
            // p.then((data)=>{
            //     console.log(data)
            // },(reason)=>{
            //     console.log(reason)
            // })

            // 封装
            // function sendAJAX(url){
            //     return new Promise((resolve,reject)=>{
            //         const xhr = new XMLHttpRequest();
            //         xhr.open('get',url);
            //         xhr.send();    
            //         xhr.onreadystatechange = function(){
            //             if(xhr.readyState == 4){
            //                 if(xhr.status>=200 && xhr.status<=300){
            //                     // 控制台输出响应状态码
            //                     resolve(xhr.response);
            //                 }else{
            //                     // 控制天输出无响应状态码
            //                     reject(xhr.status)
            //                 }
            //             }  
            //         }
            //     })
            // }
            // var p = sendAJAX('https://api.apiopen.top/getJoke');
            // p.then((data)=>{
            //     console.log(data)
            // },(reason)=>{
            //     console.log(reason)
            // })
            // var p = Promise.reject(new Promise((resolve,reject)=>{
            //     reject('Error')
            // }));
            // console.log(p)
            // p.catch(err=>{
            //     console.log(err)
            // })

            var p = new Promise((resolve,reject)=>{
                resolve(123)
            })
            var p2 = p.then((value)=>{
                console.log(1111,value+1)
                return value+1;
            }).then((value)=>{
                console.log(222,value)
                return new Promise(()=>{});
            }).then((value)=>{
                console.log(123)
                return value+'123';
            }).catch(err=>{
                console.log(err)
            })
            console.log(p2)

        }
    </script>
</body>
</html>